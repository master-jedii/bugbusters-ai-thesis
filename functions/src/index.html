<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bugbusters AI</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
  </head>
  <body>
    <!-- Firebase App (the core Firebase SDK) -->
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <!-- Firebase Database -->
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>


    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const dateselect = document.getElementById('dateselect');

        if (dateselect) {
            const today = new Date().toISOString().split("T")[0];
            dateselect.setAttribute('min', today);
        }
      });
    </script>

    <nav class="navbar  fixed-top">
        <!-- Navbar -->
        <div class="container-fluid">
          <!-- LOGO -->
    
          <!-- btn -->
          <button class="navbar-toggler shadow-none border-0 text-white" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar" aria-label="Toggle navigation">
            <i class="fa-solid fa-bars fa-custom-size"></i>
          </button>
    
          <!-- LOGO -->
          <div class="image-container">
            <a href="#"><img src="image/logo.jpg" alt="LOGO"></a>
          </div>
          <!-- Sidebar -->

          <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasNavbarLabel">
            <div class="offcanvas-header">
              <h5 class="offcanvas-title" id="offcanvasNavbarLabel">BugBuster Ai</h5>
              <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
            <div class="offcanvas-body">
              <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
                <li class="nav-item">
                  <a class="nav-link active" aria-current="page" href="#" onclick="newContent()" data-bs-dismiss="offcanvas">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#" onclick="BookingData()"data-bs-dismiss="offcanvas">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="admin/index.html">ADMIN</a>
                </li>
            </div>
          </div>
    
          <div class="profile" id="profile_line">
            <img id="lineImage">
          </div>
        </div>
    </nav>

    <div class="display_show" >
      <p class="text_display_show">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</p>
    </div>

    <div class="container" >
      <div class="content" style="display: none;">
        <div class="card" >
            <div class="text-card">
              <img src="image/logowhite.jpg" id="imglogowhite">
              <h4 style="font-weight: bold;">‡πÇ‡∏õ‡∏£‡∏î‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</h4>
              <p style="font-weight: normal;">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß</p>
              <button class="confirm-button" onclick="BookingData()">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢</button>
            </div>
        </div>  
    </div>
    

      <div id="lineProfile" style="display: none;">
        <div id="lineUID" style="display: none;">UID: Your ID</div>
        <p class="text_container">‡∏ô‡∏±‡∏î‡∏™‡∏≥‡∏£‡∏ß‡∏à</p>
        <input id="dateselect"  type="date" placeholder="‡∏ß‡∏±‡∏ô/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ " class="information">
        <p class="text_container">‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</p>
        <input type="text" id="userName" name="userName" placeholder="‡∏ä‡∏∑‡πà‡∏≠" class="information">
        <input type="text" id="userLast" name="userLast" placeholder="‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•" class="information">
        <input type="text" id="userTel" name="userTel" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå" class="information" maxlength="10">
        <p class="text_container">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</p>
        <input type="text" id="userAddress" name="userAddress" placeholder="‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà,‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô,‡∏ã‡∏≠‡∏¢" class="information">
        <div class="dropdown-container">
            <select id="province" onchange="updateAmphures()">
              <option value="">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</option>
            </select>
            </div>
          <div class="dropdown-container">
            <select id="amphure" onchange="updateTambons()">
              <option value="">‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</option>
            </select>
          </div>

          <div class="dropdown-container">
            <select id="tambon">
              <option value="">‡∏ï‡∏≥‡∏ö‡∏•</option>
            </select>
          </div>
          <pre id="selected"></pre>

          <div class="btn">
            <button id="logout" onclick="logout()">Logout</button>
            <button id="accept" onclick="showData()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
          </div>

        </div>
        <div class="showdataUser">
          <p id="userDataDisplay"></p>
        </div>
        
        
      </div>

    


    </div>
  

    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/versions/2.22.3/sdk.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <!-- <script>
      // ‡∏î‡∏∂‡∏á‡∏≠‡∏¥‡∏ô‡∏û‡∏∏‡∏ï‡∏î‡πâ‡∏ß‡∏¢ ID
      var datePicker = document.getElementById('dateselect');
  
      // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö ISO 8601 (yyyy-mm-dd)
      var today = new Date().toISOString().split('T')[0];
  
      // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ min ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
      datePicker.setAttribute('min', today);
  
      // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÉ‡∏ô input date
      datePicker.addEventListener('change', function() {
          // ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
          var selectedDate = datePicker.value;
  
          // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏≠‡∏î‡∏µ‡∏ï‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
          if (selectedDate < today) {
              // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏î‡πâ‡∏ß‡∏¢ SweetAlert
              Swal.fire({
                  icon: 'error',
                  title: '‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
                  text: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡∏≠‡∏î‡∏µ‡∏ï‡πÑ‡∏î‡πâ',
                  confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á'
              });
  
              // ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡πà‡∏≤ input date ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
              datePicker.value = today;
          }
      });
    </script> -->

    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyCxTCUmIzvkC8cTW_TETeZBOTZZ7aPqnhw",
        authDomain: "geminibugbuster.firebaseapp.com",
        databaseURL: "https://geminibugbuster-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "geminibugbuster",
        storageBucket: "geminibugbuster.appspot.com",
        messagingSenderId: "576048046575",
        appId: "1:576048046575:web:dadf68947e6a0486ec561a",
        measurementId: "G-NDN0MM76KS"
      };

  
      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);

      let profile;
      let uid;
      let badWords = []; // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡∏≥‡∏´‡∏¢‡∏≤‡∏ö‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å JSON

      // window.onload = function() {
      //     var today = new Date();
      //     var dd = today.getDate();
      //     var mm = today.getMonth() + 1; // January is 0!
      //     var yyyy = today.getFullYear();

      //     if (dd < 10) {
      //         dd = '0' + dd;
      //     }

      //     if (mm < 10) {
      //         mm = '0' + mm;
      //     }

      //     var maxDate = yyyy + '-' + mm + '-' + dd;

      //     document.getElementById('dateselect').setAttribute('min', maxDate);
      // };

      

      const main = async () => {
        await liff.init({ liffId: "2004363658-maB2r11R" });
        if (!liff.isLoggedIn()) {
          liff.login();
          return false;
        }
        profile = await liff.getProfile();
        uid = profile.userId;

        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
        const userRef = firebase.database().ref("Users/" + uid);
        userRef.once('value').then((snapshot) => {
          if (snapshot.exists()) {
            // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
            const userData = snapshot.val(); // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
            const userName = userData.name;
            const userLast = userData.lastname;
            const userAddress = userData.address;
            const userTel = userData.tel;
            const userDateSelect = userData.dateselect;

            lineImage.src = profile.pictureUrl;
            lineUID.textContent = `UID : ${profile.userId}`
            newContent();

          } else { 
            lineImage.src = profile.pictureUrl;
            lineUID.textContent = `UID : ${profile.userId}`;
            lineProfile.style.display = 'block';
          }
        });
      };

      const logout = async () => {
        liff.logout();
        main();
      };

      const toggleUID = () => {
        const uidElement = document.getElementById("lineUID");
        uidElement.style.display = uidElement.style.display === 'none' ? 'block' : 'none';
      };

      main();

      function newContent() {
        document.querySelector('.text_display_show').textContent = '‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å';
        const userRef = firebase.database().ref("Users/" + uid);  
        userRef.once('value').then((snapshot) => {
            if (snapshot.exists()) {
                // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
                document.querySelector('.content').style.display = 'block';  
                document.querySelector('.showdataUser').style.display = 'none'; 
            } else {
                // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Firebase
                document.querySelector('.showdataUser').style.display = 'none'; 
                // ‡πÅ‡∏™‡∏î‡∏á Alert
                Swal.fire({
                    icon: 'warning',
                    title: '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',
                    text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô'
                });
            }
        });
    }



    function BookingData() {
      document.querySelector('.text_display_show').textContent = '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢';  
      document.querySelector('.showdataUser').style.display = 'block'; 
      document.querySelector('.content').style.display = 'none'; 
      const userRef = firebase.database().ref("Users/" + uid);  
      userRef.once('value').then((snapshot) => {
          if (snapshot.exists()) {
              // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
              const userData = snapshot.val(); // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
              const userName = userData.name;
              const userLast = userData.lastname;
              const userAddress = userData.address;
              const userTel = userData.tel;
              const userDateSelect = userData.dateselect;
              const userProvince = userData.province;
              const userAmphure = userData.amphure;
              const userTambon = userData.tambon; 
              const status = userData.status; // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡πà‡∏≤ status

              lineImage.src = profile.pictureUrl;
              lineUID.textContent = `UID : ${profile.userId}`;
              

              // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏µ‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ status
              let statusColorClass = '';
              if (status === 'Confirmed') {
                  statusColorClass = 'text-success'; // ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß
              } else if (status === 'Canceled') {
                  statusColorClass = 'text-danger'; // ‡∏™‡∏µ‡πÅ‡∏î‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
              } else if (status === 'Not confirm') {
                  statusColorClass = 'text-warning'; // ‡∏™‡∏µ‡∏™‡πâ‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
              }


              // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô class showdataUser ‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ status
              document.querySelector('.showdataUser').innerHTML = `
              <div class="booking-container"><br>
                <p class= "bookingdata-text" >‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏™‡∏≥‡∏£‡∏ß‡∏à<p>
                <div class= "bookingdata">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å: ${userDateSelect}<br></div>
                <div class= "bookingdata" >‡∏ä‡∏∑‡πà‡∏≠: ${userName}<br></div>
                <div class= "bookingdata">‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•: ${userLast}<br></div>
                <div class= "bookingdata">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£: ${userTel}<br></div>
                <div class= "bookingdata">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà : <br>${userAddress}</div>
                <div class= "bookingdata">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î: ${userProvince}<br></div>
                <div class= "bookingdata">‡∏≠‡∏≥‡πÄ‡∏†‡∏≠: ${userAmphure}<br></div>
                <div class= "bookingdata">‡∏ï‡∏≥‡∏ö‡∏•: ${userTambon}<br></div>
                <div class= "bookingdata">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: <span class="${statusColorClass}">${status}</span><br></div>

                <button id="update" onclick="editData('${userName}', '${userLast}', '${userAddress}', '${userTel}', '${userDateSelect}','${userProvince}','${userAmphure}','${userTambon}')">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button><br>
                <button id="delete" onclick="deleteUser('${profile.userId}')">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</button>
                <button id="confirm" onclick="confirmBooking('${profile.userId}')">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</button>
              </div>
                
              `;
          } else { 
              lineImage.src = profile.pictureUrl;
              lineUID.textContent = `UID : ${profile.userId}`;
              lineProfile.style.display = 'block';

              // ‡πÅ‡∏™‡∏î‡∏á Alert ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Firebase
              Swal.fire({
                  icon: 'warning',
                  title: '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',
                  text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô'
              });
          }
      });
    }
    function confirmBooking(userId) {
      Swal.fire({
          title: "‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
          text: "‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç : ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏´‡∏≤‡∏Å‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÑ‡∏î‡πâ‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£ 3 ‡∏ß‡∏±‡∏ô",
          icon: "warning",
          showCancelButton: true,
          confirmButtonColor: "#1BBF18",
          cancelButtonColor: "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å",
          confirmButtonText: "‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á",
          reverseButtons: true,
          customClass: {
            confirmButton: 'btn-accept-reservation'
          }
          }).then((result) => {
              if (result.isConfirmed) {
                  const userRef = firebase.database().ref("Users/" + userId);
                  userRef.update({ status: "Confirmed" })
                      .then(() => {
                          Swal.fire({
                              icon: 'success',
                              title: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß',
                              timer: 1500
                          }).then(() => {
                              console.log("test success")
                              const userRef = firebase.database().ref("Users/" + userId);
                              userRef.once('value').then((snapshot) => {
                                  if (snapshot.exists()) {
                                      // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
                                      const userData = snapshot.val();
                                      const userName = userData.name;
                                      const userLast = userData.lastname;
                                      const userAddress = userData.address;
                                      const userTel = userData.tel;
                                      const userDateSelect = userData.dateselect;
                                      const userProvince = userData.province;
                                      const userAmphure = userData.amphure;
                                      const userTambon = userData.tambon; 
                                      const status = userData.status; 
                                                              
                                      // console.log(userName)
                                      const message = `‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏∏‡∏ìüëã${userName} ${userLast}üåü 
                                      \n‚úÖ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‚úÖ 
                                      \n‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
                                      \nüë§: ${userName}
                                      \nüë§: ${userLast}
                                      \nüìû: ${userTel}
                                      \nüìÖ: ${userDateSelect}
                                      \nüö©: ${userAddress} ‡∏ï.${userTambon} ‡∏≠.${userAmphure} ‡∏à.${userProvince} 
                                      \nüí°: ${status}
                                      \nüì¢‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡πÅ‡∏•‡πâ‡∏ßüì¢`;
                                      async function sendMessage(userId, message) {
                                              try {
                                                  const url = ' https://a124-103-120-115-130.ngrok-free.app/send-message'; // URL ‡∏Ç‡∏≠‡∏á proxy server ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
                                                  const data = {
                                                      to: userId,
                                                      messages: [
                                                          {
                                                              type: 'text',
                                                              text: message
                                                          }
                                                      ]
                                                  };

                                                  const response = await axios.post(url, data);
                                                  console.log('Message sent:', response.data);
                                              } catch (error) {
                                                  console.error('Error sending message:', error.response ? error.response.data : error.message);
                                              }
                                          }
                                          sendMessage(userId, message);
                                          // liff.closeWindow();
                                          }
                              });
                          });
                      })
                      .catch((error) => {
                          console.error("Error updating status: ", error);
                          Swal.fire({
                              icon: 'error',
                              title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
                              text: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÑ‡∏î‡πâ: ' + error.message
                          });
                      });
              }
          });
      }


    function deleteUser(userId) {
      const userRef = firebase.database().ref("Users/" + userId);

      userRef.once('value').then((snapshot) => {
        if (snapshot.exists()) {
          const userData = snapshot.val();
          const userDateSelect = userData.dateselect;
          const currentDate = new Date();
          
          // ‡∏´‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà user ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 3 ‡∏ß‡∏±‡∏ô
          const userSelectedDate = new Date(userDateSelect);
          const cancellationLimit = new Date(userSelectedDate);
          cancellationLimit.setUTCDate(cancellationLimit.getUTCDate() - 3); // ‡∏•‡∏ö 3 ‡∏ß‡∏±‡∏ô‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà user ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å

          // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ current date ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ cancellation limit
          if (currentDate > cancellationLimit) {
            Swal.fire({
              icon: "error",
              title: "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÑ‡∏î‡πâ ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ó‡∏≥‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 3 ‡∏ß‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà",
              showConfirmButton: false,
              timer: 3000,
              customClass: {
                title: 'my-swal-title',
                popup: 'my-swal-popup'
              }
            });
          } else {
            // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡πà‡∏≠‡∏ô 3 ‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÉ‡∏Å‡∏•‡πâ‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏±‡∏î
            Swal.fire({
              title: "‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏∞‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•?",
              text: "‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÑ‡∏î‡πâ",
              icon: "warning",
              showCancelButton: true,
              confirmButtonText: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',
              cancelButtonText: 'Cancel',
              reverseButtons: true,
            }).then((result) => {
              if (result.isConfirmed) {
                // ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                userRef.remove()
                  .then(() => {
                    // ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
                    Swal.fire({
                      icon: 'success',
                      title: '‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢',
                      text: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß'
                    });
                    // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Line server
                    const userName = userData.name;
                    const userLast = userData.lastname;
                    const userTel = userData.tel;
                    const userAddress = userData.address;
                    const userProvince = userData.province;
                    const userAmphure = userData.amphure;
                    const userTambon = userData.tambon;
                    const status = userData.status;

                    const message = `‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏∏‡∏ìüëã${userName} ${userLast}üåü 
                    \n‚ùå‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‚ùå 
                    \n‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
                    \nüë§: ${userName}
                    \nüë§: ${userLast}
                    \nüìû: ${userTel}
                    \nüìÖ: ${userDateSelect}
                    \nüö©: ${userAddress} ‡∏ï.${userTambon} ‡∏≠.${userAmphure} ‡∏à.${userProvince} 
                    \nüí°: Cancled
                    \nüì¢‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢üì¢`;

                    // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Line server
                    sendMessageToLine(userId, message);
                    // liff.closeWindow();
                  })
                  .catch((error) => {
                    console.error("Error deleting document: ", error);
                    Swal.fire({
                      icon: 'error',
                      title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
                      text: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ: ' + error.message
                    });
                  });
              }
            });
          }
        }
        });
      }

async function sendMessageToLine(userId, message) {
  try {
    const url = 'https://a124-103-120-115-130.ngrok-free.app/send-message'; // URL ‡∏Ç‡∏≠‡∏á proxy server ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
    const data = {
      to: userId,
      messages: [
        {
          type: 'text',
          text: message
        }
      ]
    };

    const response = await axios.post(url, data);
    console.log('Message sent:', response.data);
  } catch (error) {
    console.error('Error sending message:', error.response ? error.response.data : error.message);
    // Handle error here
  }
}













      // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• JSON ‡∏î‡πâ‡∏ß‡∏¢ fetch()
      fetch('badword.json')
          .then(response => response.json()) // ‡πÅ‡∏õ‡∏•‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô JSON
          .then(data => {
              // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏≥‡∏´‡∏¢‡∏≤‡∏ö‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ badWords
              badWords = data;
          })
          .catch(error => console.error('Error loading JSON:', error)); // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î

      // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏´‡∏¢‡∏≤‡∏ö
      function containsBadWords(input) {
          // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏´‡∏¢‡∏≤‡∏ö‡∏à‡∏≤‡∏Å‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ badWords
          for (const word of badWords) {
              if (input.includes(word)) {
                  return true;
              }
          }
          return false;
      }


    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô showData ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ dateselect ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏õ
    function showData() {
        const userName = document.getElementById("userName").value;
        const userLast = document.getElementById("userLast").value;
        const userAddress = document.getElementById("userAddress").value;
        const userTel = document.getElementById("userTel").value;
        const dateselect = document.getElementById('dateselect').value;
        const provinceSelect = document.getElementById("province");
        const amphureSelect = document.getElementById("amphure");
        const tambonSelect = document.getElementById("tambon");
        const status = "Not confirm"; // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô

        const selectedProvinceText = provinceSelect.options[provinceSelect.selectedIndex].text || "Select Province";
        const selectedAmphureText = amphureSelect.options[amphureSelect.selectedIndex].text || "Select Amphure";
        const selectedTambonText = tambonSelect.options[tambonSelect.selectedIndex].text || "Select Tambon";

        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏´‡∏¢‡∏≤‡∏ö
        if (containsBadWords(userName) || containsBadWords(userLast) || containsBadWords(userAddress)) {
            Swal.fire({
                icon: 'error',
                title: '‡∏û‡∏ö‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°',
                text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏´‡∏¢‡∏≤‡∏ö‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å'
            });
            return;
        }


        if (userName && userLast && userAddress && userTel && dateselect) {
            const bookingRef = firebase.database().ref("Booking/");
            bookingRef.once('value').then((snapshot) => {
                let dateBooked = false;
                snapshot.forEach((childSnapshot) => {
                    if (childSnapshot.val().dateselect === dateselect) {
                        dateBooked = true;
                    }
                });
                if (dateBooked) {
                    Swal.fire({
                        icon: 'error',
                        title: '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ñ‡∏π‡∏Å‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß',
                        text: '‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏∑‡πà‡∏ô',
                        confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á'
                    });
                } else {
                  Swal.fire({
                    icon: "warning",
                    title: "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢",
                    html: `
                    <div class="SwalDesign">
                        <label><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å:</strong></label><br>
                        <input type="date" id="dateselect" value="${dateselect}"><br>
                        <label><strong>‡∏ä‡∏∑‡πà‡∏≠:</strong></label>
                        <input type="text" id="swal-input1" value="${userName}">
                        <label><strong>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:</strong></label>
                        <input type="text" id="swal-input2" value="${userLast}">
                        <label><strong>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£:</strong></label>
                        <input type="text" id="swal-input3" value="${userTel}">
                        <br><br>
                        <label><strong>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</strong></label>
                        <input type="text" id="swal-input4" value="${userAddress}">
                        <label><strong>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î:</strong></label>
                        <input type="text" id="swal-input5" value="${selectedProvinceText}">
                        <label><strong>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠:</strong></label>
                        <input type="text" id="swal-input6" value="${selectedAmphureText}">
                        <label><strong>‡∏ï‡∏≥‡∏ö‡∏•:</strong></label>
                        <input type="text" id="swal-input7" value="${selectedTambonText}">
                    </div>
                    `,
                    showCancelButton: true,
                    confirmButtonText: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å',
                    cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',
                    didOpen: () => {
                        const today = new Date().toISOString().split("T")[0];
                        document.getElementById('dateselect').setAttribute('min', today);
                    },
                    reverseButtons: true,
                    preConfirm: () => {
                        const updatedDateselect = document.getElementById('dateselect').value;
                        const updatedUserName = document.getElementById('swal-input1').value;
                        const updatedUserLast = document.getElementById('swal-input2').value;
                        const updatedUserTel = document.getElementById('swal-input3').value;
                        const updatedUserAddress = document.getElementById('swal-input4').value;
                        const updatedProvince = document.getElementById('swal-input5').value;
                        const updatedAmphure = document.getElementById('swal-input6').value;
                        const updatedTambon = document.getElementById('swal-input7').value;

                        if (containsBadWords(updatedUserName) || containsBadWords(updatedUserLast) || containsBadWords(updatedUserAddress)) {
                            Swal.fire({
                                icon: 'error',
                                title: '‡∏û‡∏ö‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°',
                                text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏´‡∏¢‡∏≤‡∏ö‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å'
                            });
                            return false; // ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
                        }

                        // ‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô writeDatabase
                        writeDatabase(
                            updatedUserName || userName, 
                            updatedUserLast || userLast, 
                            updatedUserAddress || userAddress, 
                            updatedUserTel || userTel, 
                            updatedDateselect || dateselect, 
                            updatedProvince || selectedProvinceText, 
                            updatedAmphure || selectedAmphureText, 
                            updatedTambon || selectedTambonText, 
                            status
                        ); 
                    },
                    customClass: {
                        title: 'custom-title-class',
                        htmlContainer: 'custom-html-container-class',
                        confirmButton: 'swal2-confirm',
                        cancelButton: 'custom-cancel-button-class',
                        iconSwal_custom: 'icon'
                    }
                });

                }
            });
        } else {
            Swal.fire({
                icon: "error",
                title: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö",
            });
        }
    }


    
    function writeDatabase(userName, userLast, userAddress, userTel, dateselect, province, amphure, tambon, status) {
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏°‡∏≤‡∏ß‡πà‡∏≤‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
    if (userName && userLast && userAddress && userTel && dateselect && uid) {
        // ‡∏™‡∏£‡πâ‡∏≤‡∏á timestamp ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
        const currentTimestamp = new Date().toString(); 

        firebase.database().ref("Users").orderByChild("dateselect").equalTo(dateselect).once('value', (snapshot) => {
            if (snapshot.exists()) {
                Swal.fire({
                    icon: 'error',
                    title: '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á',
                    text: '‡∏Ñ‡∏¥‡∏ß‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏ï‡πá‡∏°‡πÅ‡∏•‡πâ‡∏ß'
                });
            } else {
                // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡πÉ‡∏ô Firebase Realtime Database
                firebase.database().ref("Users/" + uid).set({
                    name: userName,
                    lastname: userLast,
                    address: userAddress,
                    province: province,
                    amphure: amphure,
                    tambon: tambon,
                    tel: userTel,
                    dateselect: dateselect,
                    status: status,
                    timestamp: currentTimestamp // Include current timestamp
                }).then(() => {
                    Swal.fire({
                        icon: 'success',
                        title: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢',
                        showConfirmButton: true,
                        timer: 1500
                    }).then(() => {
                        location.reload(); // ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÉ‡∏´‡∏°‡πà‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
                    });
                }).catch((error) => {
                    Swal.fire({
                        icon: "error",
                        title: "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
                        text: error.message
                    });
                });
            }
        });
    } else {
        Swal.fire({
            icon: "error",
            title: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö",
        });
    }
}







      
    function editData(userName, userLast, userAddress, userTel, dateselect ,userProvince,userAmphure,userTambon) {
    Swal.fire({
        icon: "info",
        title: "‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
        html: `
            <div class = "SwalDesignEdit">
                <label><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å:</strong></label><br>
                <input type="date" id="swal-input1"  value="${dateselect}"><br>
                <label><strong>‡∏ä‡∏∑‡πà‡∏≠:</strong></label>
                <input type="text" id="swal-input2"  value="${userName}">
                <label><strong>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:</strong></label>
                <input type="text" id="swal-input3"  value="${userLast}">
                <label><strong>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£:</strong></label>
                <input type="text" id="swal-input4"  value="${userTel}">
                <label><strong>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</strong></label>
                <input type="text" id="swal-input5"  value="${userAddress}">         
                <label><strong>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î:</strong></label>
                <input type="text" id="swal-input6"  value="${userProvince}">
                <label><strong>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠:</strong></label>
                <input type="text" id="swal-input7"  value="${userAmphure}">
                <label><strong>‡∏ï‡∏≥‡∏ö‡∏•:</strong></label>
                <input type="text" id="swal-input8" value="${userTambon}">
            </div>
        `,
        
        showCancelButton: true,
        confirmButtonText: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å',
        cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',
        reverseButtons: true,
        customClass: {
            popup: 'custom-swal-width',
            iconSwal_custom:'icon',
            confirmButtonText:'btn-edit',
            
        } ,
        preConfirm: () => {
            const newDateSelect = document.getElementById("swal-input1").value; 
            const newName = document.getElementById("swal-input2").value; 
            const newLast = document.getElementById("swal-input3").value;
            const newTel = document.getElementById("swal-input4").value;
            const newAddress = document.getElementById("swal-input5").value; 
            const newProvince = document.getElementById("swal-input6").value;
            const newAmphure = document.getElementById("swal-input7").value;
            const newTambon= document.getElementById("swal-input8").value;

            if (containsBadWords(newName) || containsBadWords(newLast) || containsBadWords(newAddress)) {
                Swal.fire({
                    icon: 'error',
                    title: '‡∏û‡∏ö‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°',
                    text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏´‡∏¢‡∏≤‡∏ö‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å'
                });
                return false;
            }

            if (newName && newLast && newAddress && newTel && newDateSelect) {
                const dateRef = firebase.database().ref("Users").orderByChild("dateselect").equalTo(newDateSelect);
                dateRef.once('value', (snapshot) => {
                    if (snapshot.exists() && !snapshot.hasChild(uid)) {
                      Swal.fire({
                      icon: 'error',
                      title: '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á',
                      text: '‡∏Ñ‡∏¥‡∏ß‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏ï‡πá‡∏°‡πÅ‡∏•‡πâ‡∏ß'
                  });
                    } else {
                        firebase.database().ref("Users/" + uid).update({
                            name: newName,
                            lastname: newLast,
                            address: newAddress,
                            tel: newTel,
                            dateselect: newDateSelect,
                            province : newProvince,
                            amphure : newAmphure,
                            tambon : newTambon,
                            
                        }).then(() => {
                          Swal.fire({
                          icon: 'success',
                          title: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢',
                          showConfirmButton: true,
                          timer: 1500
                        }).then(() => {
                          location.reload();
                        });
                        }).catch((error) => {
                            alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: " + error.message);
                        });
                    }
                });
            } else {
                alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô");
            }
        }
    });
  }

  //////////API/////////////
  const provincesToInclude = [
    { id: 1, name: "‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£" },  // Bangkok
    { id: 2, name: "‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ" },         // Nonthaburi
    { id: 3, name: "‡∏õ‡∏ó‡∏∏‡∏°‡∏ò‡∏≤‡∏ô‡∏µ" },        // Pathum Thani
    { id: 4, name: "‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£" },    // Samut Prakan
    { id: 5, name: "‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£" },      // Samut Sakhon
    { id: 6, name: "‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°" }          // Nakhon Pathom
];

    function populateProvinces() {
        fetch(
            "https://raw.githubusercontent.com/kongvut/thai-province-data/master/api_province_with_amphure_tambon.json"
        )
            .then((response) => response.json())
            .then((result) => {
                const provinceSelect = document.getElementById("province");
                for (const province of Object.values(result)) {
                    if (provincesToInclude.some(p => p.name === province.name_th)) {
                        const option = document.createElement("option");
                        option.value = province.id;
                        option.textContent = province.name_th;
                        provinceSelect.appendChild(option);
                    }
                }
            });
    }

    // Function to update districts dropdown based on selected province
    function updateAmphures() {
        const provinceSelect = document.getElementById("province");
        const amphureSelect = document.getElementById("amphure");
        amphureSelect.innerHTML = '<option value="">Select ...</option>';
        const selectedProvinceId = provinceSelect.value;
        if (!selectedProvinceId) return;
        fetch(
            "https://raw.githubusercontent.com/kongvut/thai-province-data/master/api_province_with_amphure_tambon.json"
        )
            .then((response) => response.json())
            .then((result) => {
                const selectedProvince = result.find(province => province.id === parseInt(selectedProvinceId));
                if (!selectedProvince) return;
                const amphures = selectedProvince.amphure;
                for (const amphure of amphures) {
                    const option = document.createElement("option");
                    option.value = amphure.id;
                    option.textContent = amphure.name_th;
                    amphureSelect.appendChild(option);
                }
            });
    }

    // Function to update tambons dropdown based on selected amphure
    function updateTambons() {
        const amphureSelect = document.getElementById("amphure");
        const tambonSelect = document.getElementById("tambon");
        tambonSelect.innerHTML = '<option value="">Select ...</option>';
        const selectedAmphureId = amphureSelect.value;
        if (!selectedAmphureId) return;
        fetch(
            "https://raw.githubusercontent.com/kongvut/thai-province-data/master/api_province_with_amphure_tambon.json"
        )
            .then((response) => response.json())
            .then((result) => {
                const selectedProvinceId = document.getElementById("province").value;
                const selectedProvince = result.find(province => province.id === parseInt(selectedProvinceId));
                if (!selectedProvince) return;
                const selectedAmphure = selectedProvince.amphure.find(amphure => amphure.id === parseInt(selectedAmphureId));
                if (!selectedAmphure) return;
                const tambons = selectedAmphure.tambon;
                for (const tambon of tambons) {
                    const option = document.createElement("option");
                    option.value = tambon.id;
                    option.textContent = tambon.name_th;
                    tambonSelect.appendChild(option);
                }
            });
    }

    // Event listener when DOM content is loaded, call populateProvinces function
    document.addEventListener("DOMContentLoaded", populateProvinces);

    // Event listeners for updating dropdowns
    document.getElementById("province").addEventListener("change", updateAmphures);
    document.getElementById("amphure").addEventListener("change", updateTambons);

    </script>
</body>



</html>